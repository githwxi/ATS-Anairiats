/*
**
** The C code is generated by ATS/Anairiats
** The compilation time is: 2018-1-26: 18h:27m
**
*/

/* include some .h files */
#ifndef _ATS_HEADER_NONE
#include "ats_config.h"
#include "ats_basics.h"
#include "ats_types.h"
#include "ats_exception.h"
#include "ats_memory.h"
#endif /* _ATS_HEADER_NONE */

/* include some .cats files */
#ifndef _ATS_PRELUDE_NONE
#include "prelude/CATS/basics.cats"
#include "prelude/CATS/integer.cats"
#include "prelude/CATS/sizetype.cats"
#include "prelude/CATS/integer_ptr.cats"
#include "prelude/CATS/integer_fixed.cats"
#include "prelude/CATS/pointer.cats"
#include "prelude/CATS/bool.cats"
#include "prelude/CATS/char.cats"
#include "prelude/CATS/byte.cats"
#include "prelude/CATS/float.cats"
#include "prelude/CATS/string.cats"
#include "prelude/CATS/reference.cats"
#include "prelude/CATS/lazy.cats"
#include "prelude/CATS/lazy_vt.cats"
#include "prelude/CATS/printf.cats"
#include "prelude/CATS/list.cats"
#include "prelude/CATS/option.cats"
#include "prelude/CATS/array.cats"
#include "prelude/CATS/matrix.cats"
#endif /* _ATS_PRELUDE_NONE */
/* prologues from statically loaded files */

#include "libc/CATS/pthread.cats"

#include "libc/CATS/stdio.cats"

#include "libc/sys/CATS/types.cats"

#include "libc/CATS/pthread.cats"

#include "libc/CATS/pthread_uplock.cats"
/* external codes at top */


//
// HX-2010-03-28: this style cannot safely support GC
//
typedef struct {
  pthread_mutex_t mutex ; void* value[0] ;
} pthread_mutexref_struct ;

/* ****** ****** */

static inline
ats_ptr_type
atslib_pthread_mutexref_create_tsz
  (ats_ptr_type p_x, ats_size_type tsz) {
  pthread_mutexref_struct *p ;
  p = ATS_MALLOC(sizeof (pthread_mutexref_struct) + tsz) ;
  pthread_mutex_init (&(p->mutex), NULL) ;
  memcpy (&(p->value), p_x, (size_t)tsz) ;
  return p ;
} // end of [atslib_pthread_mutexref_create_tsz]

static inline
ats_ptr_type
atslib_pthread_mutexref_lock
  (ats_ptr_type p0) {
  pthread_mutexref_struct *p = p0 ;
  pthread_mutex_lock (&(p->mutex)) ;
  return &(p->value) ;
} // end of [atslib_pthread_mutexref_lock]

static inline
ats_void_type
atslib_pthread_mutexref_unlock
  (ats_ptr_type p_value) {
  pthread_mutex_unlock (
    (pthread_mutex_t*)((char*)p_value - sizeof(pthread_mutexref_struct))
  ) ;
  return ;
} // end of [atslib_pthread_mutexref_unlock]


/* type definitions */
/* external typedefs */
/* external dynamic constructor declarations */
/* external dynamic constant declarations */
ATSextern_fun(ats_void_type, atspre_assert) (ats_bool_type) ;
ATSextern_fun(ats_void_type, atspre_assert_errmsg) (ats_bool_type, ats_ptr_type) ;
ATSextern_fun(ats_void_type, atspre_cloptr_free) (ats_ptr_type) ;
ATSextern_fun(ats_bool_type, atspre_lt_int_int) (ats_int_type, ats_int_type) ;
ATSextern_fun(ats_bool_type, atspre_gt_int_int) (ats_int_type, ats_int_type) ;
ATSextern_fun(ats_int_type, atspre_int1_of_string) (ats_ptr_type) ;
ATSextern_fun(ats_int_type, atspre_isub) (ats_int_type, ats_int_type) ;
ATSextern_fun(ats_bool_type, atspre_ilt) (ats_int_type, ats_int_type) ;
ATSextern_fun(ats_bool_type, atspre_igt) (ats_int_type, ats_int_type) ;
ATSextern_fun(ats_bool_type, atspre_igte) (ats_int_type, ats_int_type) ;
ATSextern_fun(ats_bool_type, atspre_ieq) (ats_int_type, ats_int_type) ;
ATSextern_fun(ats_void_type, atspre_printf_exn) (ats_ptr_type, ...) ;
ATSextern_fun(ats_void_type, atspre_prerrf_exn) (ats_ptr_type, ...) ;
ATSextern_fun(ats_int_type, ats_pthread_create_detached) (ats_ptr_type, ats_ptr_type, ats_ref_type) ;
ATSextern_fun(ats_void_type, ATS_2d0_2e2_2e12_2libc_2SATS_2pthread_2esats__pthread_create_detached_exn) (ats_ptr_type, ats_ptr_type, ats_ref_type) ;
ATSextern_fun(ats_void_type, ATS_2d0_2e2_2e12_2libc_2SATS_2pthread_2esats__pthread_create_detached_cloptr) (ats_clo_ptr_type, ats_ref_type) ;
ATSextern_fun(ats_void_type, atslib_perror) (ats_ptr_type) ;
ATSextern_fun(ats_ptr_type, atslib_pthread_uplock_create) () ;
ATSextern_fun(ats_void_type, atslib_pthread_uplock_download) (ats_ptr_type) ;
ATSextern_fun(ats_void_type, atslib_pthread_uplock_destroy) (ats_ptr_type) ;
ATSextern_fun(ats_ptr_type, atslib_pthread_uplock_upticket_create) (ats_ptr_type) ;
ATSextern_fun(ats_void_type, atslib_pthread_uplock_upticket_upload_and_destroy) (ats_ptr_type) ;
ATSextern_fun(ats_ptr_type, atslib_pthread_mutexref_create_tsz) (ats_ptr_type, ats_size_type) ;
ATSextern_fun(ats_ptr_type, atslib_pthread_mutexref_lock) (ats_ptr_type) ;
ATSextern_fun(ats_void_type, atslib_pthread_mutexref_unlock) (ats_ptr_type) ;

/* external dynamic terminating constant declarations */
#ifdef _ATS_PROOFCHECK
extern
ats_void_type ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__gcd_lemma0_prfck () ;
extern
ats_void_type ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__gcd_lemma1_prfck () ;
extern
ats_void_type ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__gcd_lemma2_prfck () ;
extern
ats_void_type ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__gcd_lemma3_prfck () ;
extern
ats_void_type ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__discard_prfck () ;
#endif /* _ATS_PROOFCHECK */

/* assuming abstract types */
/* sum constructor declarations */
/* exn constructor declarations */
/* global dynamic (non-functional) constant declarations */
/* internal function declarations */
static
ats_bool_type gcd_flag_0 (ats_int_type arg0, ats_ptr_type arg1, ats_ptr_type arg2) ;
static
ats_ptr_type pthread_mutexref_create_01856_ats_int_type (ats_int_type arg0) ;
static
ats_void_type gcd_worker_3 (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type arg0, ats_int_type arg1) ;
static
ats_clo_ptr_type gcd_worker_3_closure_make (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2) ;
static
ats_void_type gcd_worker_3_clofun (ats_clo_ptr_type cloptr, ats_ptr_type arg0, ats_int_type arg1) ;
static
ats_void_type __ats_fun_4 (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type env3) ;
static
ats_clo_ptr_type __ats_fun_4_closure_make (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type env3) ;
static
ats_void_type __ats_fun_4_clofun (ats_clo_ptr_type cloptr) ;
static
ats_void_type __ats_fun_5 (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type env3) ;
static
ats_clo_ptr_type __ats_fun_5_closure_make (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type env3) ;
static
ats_void_type __ats_fun_5_clofun (ats_clo_ptr_type cloptr) ;
static
ats_int_type gcd_mt_1 (ats_int_type arg0, ats_int_type arg1) ;
static
ats_int_type gcd_main_6 (ats_int_type arg0, ats_int_type arg1) ;
static
ats_void_type usage_7 (ats_ptr_type arg0) ;

/* partial value template declarations */
/* static temporary variable declarations */
/* external value variable declarations */

/* function implementations */

/*
// /home/hwxi/Research/ATS-Anairiats/doc/EXAMPLE/MISC/gcd_mt.dats: 2820(line=111, offs=5) -- 3554(line=137, offs=4)
*/
ATSstaticdec()
ats_bool_type
gcd_flag_0 (ats_int_type arg0, ats_ptr_type arg1, ats_ptr_type arg2) {
/* local vardec */
ATSlocal (ats_bool_type, tmp0) ;
ATSlocal (ats_int_type, tmp1) ;
ATSlocal (ats_int_type, tmp2) ;
ATSlocal (ats_bool_type, tmp3) ;
ATSlocal (ats_bool_type, tmp4) ;
ATSlocal (ats_int_type, tmp5) ;
ATSlocal (ats_bool_type, tmp6) ;
ATSlocal (ats_bool_type, tmp7) ;
ATSlocal (ats_int_type, tmp8) ;

__ats_lab_gcd_flag_0:
tmp1 = ats_ptrget_mac(ats_int_type, arg1) ;
tmp2 = ats_ptrget_mac(ats_int_type, arg2) ;
tmp3 = atspre_igt (tmp1, tmp2) ;
if (tmp3) {
tmp4 = atspre_gt_int_int (arg0, 0) ;
if (tmp4) {
tmp5 = atspre_isub (tmp1, tmp2) ;
ats_ptrget_mac(ats_int_type, arg1) = tmp5 ;
arg0 = arg0 ;
arg1 = arg1 ;
arg2 = arg2 ;
goto __ats_lab_gcd_flag_0 ; // tail call
} else {
tmp0 = ats_false_bool ;
} /* end of [if] */
} else {
tmp6 = atspre_ilt (tmp1, tmp2) ;
if (tmp6) {
tmp7 = atspre_lt_int_int (arg0, 0) ;
if (tmp7) {
tmp8 = atspre_isub (tmp2, tmp1) ;
ats_ptrget_mac(ats_int_type, arg2) = tmp8 ;
arg0 = arg0 ;
arg1 = arg1 ;
arg2 = arg2 ;
goto __ats_lab_gcd_flag_0 ; // tail call
} else {
tmp0 = ats_false_bool ;
} /* end of [if] */
} else {
tmp0 = ats_true_bool ;
} /* end of [if] */
} /* end of [if] */
return (tmp0) ;
} /* end of [gcd_flag_0] */

/*
// /home/hwxi/Research/ATS-Anairiats/doc/EXAMPLE/MISC/gcd_mt.dats: 1219(line=46, offs=25) -- 1309(line=50, offs=4)
*/
ATSstaticdec()
ats_ptr_type
pthread_mutexref_create_01856_ats_int_type (ats_int_type arg0) {
/* local vardec */
ATSlocal (ats_ptr_type, tmp14) ;
ATSlocal (ats_int_type, tmp15) ;

__ats_lab_pthread_mutexref_create_01856_ats_int_type:
/* ats_int_type tmp15 ; */
tmp15 = arg0 ;
tmp14 = atslib_pthread_mutexref_create_tsz ((&tmp15), sizeof(ats_int_type)) ;
return (tmp14) ;
} /* end of [pthread_mutexref_create_01856_ats_int_type] */

/*
// /home/hwxi/Research/ATS-Anairiats/doc/EXAMPLE/MISC/gcd_mt.dats: 3838(line=145, offs=7) -- 4222(line=155, offs=6)
*/
ATSstaticdec()
ats_void_type
gcd_worker_3 (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type arg0, ats_int_type arg1) {
/* local vardec */
// ATSlocal_void (tmp16) ;
ATSlocal (ats_ptr_type, tmp17) ;
ATSlocal (ats_ptr_type, tmp18) ;
ATSlocal (ats_bool_type, tmp19) ;
// ATSlocal_void (tmp20) ;

__ats_lab_gcd_worker_3:
tmp17 = atslib_pthread_mutexref_lock (env2) ;
tmp18 = ats_selsin_mac(tmp17, atslab_2) ;
tmp19 = gcd_flag_0 (arg1, env0, env1) ;
/* tmp20 = */ atslib_pthread_mutexref_unlock (tmp18) ;
if (tmp19) {
/* tmp16 = */ atslib_pthread_uplock_upticket_upload_and_destroy (arg0) ;
} else {
arg0 = arg0 ;
arg1 = arg1 ;
goto __ats_lab_gcd_worker_3 ; // tail call
} /* end of [if] */
return /* (tmp16) */ ;
} /* end of [gcd_worker_3] */

typedef struct {
ats_fun_ptr_type closure_fun ;
ats_ptr_type closure_env_0 ;
ats_ptr_type closure_env_1 ;
ats_ptr_type closure_env_2 ;
} gcd_worker_3_closure_type ;

ats_void_type
gcd_worker_3_clofun (ats_clo_ptr_type cloptr, ats_ptr_type arg0, ats_int_type arg1) {
gcd_worker_3 (((gcd_worker_3_closure_type*)cloptr)->closure_env_0, ((gcd_worker_3_closure_type*)cloptr)->closure_env_1, ((gcd_worker_3_closure_type*)cloptr)->closure_env_2, arg0, arg1) ; return ;
} /* end of function */

ATSinline()
ats_void_type
gcd_worker_3_closure_init (gcd_worker_3_closure_type *p_clo, ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2) {
p_clo->closure_fun = (ats_fun_ptr_type)&gcd_worker_3_clofun ;
p_clo->closure_env_0 = env0 ;
p_clo->closure_env_1 = env1 ;
p_clo->closure_env_2 = env2 ;
return ;
} /* end of function */

ats_clo_ptr_type
gcd_worker_3_closure_make (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2) {
gcd_worker_3_closure_type *p_clo = ATS_MALLOC(sizeof(gcd_worker_3_closure_type)) ;
gcd_worker_3_closure_init (p_clo, env0, env1, env2) ;
return (ats_clo_ptr_type)p_clo ;
} /* end of function */

/*
// /home/hwxi/Research/ATS-Anairiats/doc/EXAMPLE/MISC/gcd_mt.dats: 4413(line=160, offs=44) -- 4450(line=160, offs=81)
*/
ATSstaticdec()
ats_void_type
__ats_fun_4 (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type env3) {
/* local vardec */
// ATSlocal_void (tmp25) ;

__ats_lab___ats_fun_4:
/* tmp25 = */ gcd_worker_3 (env0, env1, env2, env3, 1) ;
return /* (tmp25) */ ;
} /* end of [__ats_fun_4] */

typedef struct {
ats_fun_ptr_type closure_fun ;
ats_ptr_type closure_env_0 ;
ats_ptr_type closure_env_1 ;
ats_ptr_type closure_env_2 ;
ats_ptr_type closure_env_3 ;
} __ats_fun_4_closure_type ;

ats_void_type
__ats_fun_4_clofun (ats_clo_ptr_type cloptr) {
__ats_fun_4 (((__ats_fun_4_closure_type*)cloptr)->closure_env_0, ((__ats_fun_4_closure_type*)cloptr)->closure_env_1, ((__ats_fun_4_closure_type*)cloptr)->closure_env_2, ((__ats_fun_4_closure_type*)cloptr)->closure_env_3) ; return ;
} /* end of function */

ATSinline()
ats_void_type
__ats_fun_4_closure_init (__ats_fun_4_closure_type *p_clo, ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type env3) {
p_clo->closure_fun = (ats_fun_ptr_type)&__ats_fun_4_clofun ;
p_clo->closure_env_0 = env0 ;
p_clo->closure_env_1 = env1 ;
p_clo->closure_env_2 = env2 ;
p_clo->closure_env_3 = env3 ;
return ;
} /* end of function */

ats_clo_ptr_type
__ats_fun_4_closure_make (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type env3) {
__ats_fun_4_closure_type *p_clo = ATS_MALLOC(sizeof(__ats_fun_4_closure_type)) ;
__ats_fun_4_closure_init (p_clo, env0, env1, env2, env3) ;
return (ats_clo_ptr_type)p_clo ;
} /* end of function */

/*
// /home/hwxi/Research/ATS-Anairiats/doc/EXAMPLE/MISC/gcd_mt.dats: 4624(line=165, offs=44) -- 4661(line=165, offs=81)
*/
ATSstaticdec()
ats_void_type
__ats_fun_5 (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type env3) {
/* local vardec */
// ATSlocal_void (tmp30) ;

__ats_lab___ats_fun_5:
/* tmp30 = */ gcd_worker_3 (env0, env1, env2, env3, -1) ;
return /* (tmp30) */ ;
} /* end of [__ats_fun_5] */

typedef struct {
ats_fun_ptr_type closure_fun ;
ats_ptr_type closure_env_0 ;
ats_ptr_type closure_env_1 ;
ats_ptr_type closure_env_2 ;
ats_ptr_type closure_env_3 ;
} __ats_fun_5_closure_type ;

ats_void_type
__ats_fun_5_clofun (ats_clo_ptr_type cloptr) {
__ats_fun_5 (((__ats_fun_5_closure_type*)cloptr)->closure_env_0, ((__ats_fun_5_closure_type*)cloptr)->closure_env_1, ((__ats_fun_5_closure_type*)cloptr)->closure_env_2, ((__ats_fun_5_closure_type*)cloptr)->closure_env_3) ; return ;
} /* end of function */

ATSinline()
ats_void_type
__ats_fun_5_closure_init (__ats_fun_5_closure_type *p_clo, ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type env3) {
p_clo->closure_fun = (ats_fun_ptr_type)&__ats_fun_5_clofun ;
p_clo->closure_env_0 = env0 ;
p_clo->closure_env_1 = env1 ;
p_clo->closure_env_2 = env2 ;
p_clo->closure_env_3 = env3 ;
return ;
} /* end of function */

ats_clo_ptr_type
__ats_fun_5_closure_make (ats_ptr_type env0, ats_ptr_type env1, ats_ptr_type env2, ats_ptr_type env3) {
__ats_fun_5_closure_type *p_clo = ATS_MALLOC(sizeof(__ats_fun_5_closure_type)) ;
__ats_fun_5_closure_init (p_clo, env0, env1, env2, env3) ;
return (ats_clo_ptr_type)p_clo ;
} /* end of function */

/*
// /home/hwxi/Research/ATS-Anairiats/doc/EXAMPLE/MISC/gcd_mt.dats: 3581(line=139, offs=5) -- 5343(line=186, offs=4)
*/
ATSstaticdec()
ats_int_type
gcd_mt_1 (ats_int_type arg0, ats_int_type arg1) {
/* local vardec */
ATSlocal (ats_int_type, tmp9) ;
ATSlocal (ats_int_type, tmp10) ;
ATSlocal (ats_int_type, tmp11) ;
ATSlocal (ats_int_type, tmp12) ;
ATSlocal (ats_ptr_type, tmp13) ;
ATSlocal (ats_ptr_type, tmp21) ;
ATSlocal (ats_ptr_type, tmp22) ;
ATSlocal (pthread_t, tmp23) ;
// ATSlocal_void (tmp24) ;
ATSlocal (ats_ptr_type, tmp26) ;
ATSlocal (ats_ptr_type, tmp27) ;
ATSlocal (pthread_t, tmp28) ;
// ATSlocal_void (tmp29) ;
// ATSlocal_void (tmp31) ;
// ATSlocal_void (tmp32) ;
// ATSlocal_void (tmp33) ;
// ATSlocal_void (tmp34) ;
// ATSlocal_void (tmp35) ;
// ATSlocal_void (tmp36) ;
ATSlocal (ats_ptr_type, tmp37) ;
ATSlocal (ats_ptr_type, tmp38) ;
ATSlocal (ats_int_type, tmp39) ;
ATSlocal (ats_int_type, tmp40) ;
// ATSlocal_void (tmp41) ;
ATSlocal (ats_bool_type, tmp42) ;

__ats_lab_gcd_mt_1:
/* ats_int_type tmp10 ; */
tmp10 = arg0 ;
/* ats_int_type tmp11 ; */
tmp11 = arg1 ;
tmp12 = 0 ;
tmp13 = pthread_mutexref_create_01856_ats_int_type (tmp12) ;
tmp21 = atslib_pthread_uplock_create () ;
tmp22 = atslib_pthread_uplock_upticket_create (tmp21) ;
/* pthread_t tmp23 ; */
/* tmp24 = */ ATS_2d0_2e2_2e12_2libc_2SATS_2pthread_2esats__pthread_create_detached_cloptr (__ats_fun_4_closure_make ((&tmp10), (&tmp11), tmp13, tmp22), (&tmp23)) ;
tmp26 = atslib_pthread_uplock_create () ;
tmp27 = atslib_pthread_uplock_upticket_create (tmp26) ;
/* pthread_t tmp28 ; */
/* tmp29 = */ ATS_2d0_2e2_2e12_2libc_2SATS_2pthread_2esats__pthread_create_detached_cloptr (__ats_fun_5_closure_make ((&tmp10), (&tmp11), tmp13, tmp27), (&tmp28)) ;
/* tmp31 = */ atslib_pthread_uplock_download (tmp21) ;
/* tmp32 = ats_selsin_mac(tmp31, atslab_1) */ ;
/* tmp33 = */ atslib_pthread_uplock_destroy (tmp21) ;
/* tmp34 = */ atslib_pthread_uplock_download (tmp26) ;
/* tmp35 = ats_selsin_mac(tmp34, atslab_1) */ ;
/* tmp36 = */ atslib_pthread_uplock_destroy (tmp26) ;
tmp37 = atslib_pthread_mutexref_lock (tmp13) ;
tmp38 = ats_selsin_mac(tmp37, atslab_2) ;
tmp39 = tmp10 ;
tmp40 = tmp11 ;
tmp42 = atspre_ieq (tmp39, tmp40) ;
/* tmp41 = */ atspre_assert (tmp42) ;
tmp9 = tmp39 ;
return (tmp9) ;
} /* end of [gcd_mt_1] */

/*
// /home/hwxi/Research/ATS-Anairiats/doc/EXAMPLE/MISC/gcd_mt.dats: 5368(line=188, offs=5) -- 5520(line=193, offs=4)
*/
ATSstaticdec()
ats_int_type
gcd_main_6 (ats_int_type arg0, ats_int_type arg1) {
/* local vardec */
ATSlocal (ats_int_type, tmp43) ;

__ats_lab_gcd_main_6:
tmp43 = gcd_mt_1 (arg0, arg1) ;
return (tmp43) ;
} /* end of [gcd_main_6] */

/*
// /home/hwxi/Research/ATS-Anairiats/doc/EXAMPLE/MISC/gcd_mt.dats: 5654(line=200, offs=4) -- 5752(line=201, offs=71)
*/
ATSstaticdec()
ats_void_type
usage_7 (ats_ptr_type arg0) {
/* local vardec */
// ATSlocal_void (tmp44) ;

__ats_lab_usage_7:
/* tmp44 = */ atspre_prerrf_exn (ATSstrcst("Usage: %s [positive integer] [positive integer]\n"), arg0) ;
return /* (tmp44) */ ;
} /* end of [usage_7] */

/*
// /home/hwxi/Research/ATS-Anairiats/doc/EXAMPLE/MISC/gcd_mt.dats: 5769(line=203, offs=16) -- 6246(line=215, offs=4)
*/
ATSglobaldec()
ats_void_type
mainats (ats_int_type arg0, ats_ref_type arg1) {
/* local vardec */
// ATSlocal_void (tmp45) ;
// ATSlocal_void (tmp46) ;
ATSlocal (ats_bool_type, tmp47) ;
// ATSlocal_void (tmp48) ;
ATSlocal (ats_ptr_type, tmp49) ;
// ATSlocal_void (tmp50) ;
ATSlocal (ats_bool_type, tmp51) ;
ATSlocal (ats_int_type, tmp52) ;
ATSlocal (ats_ptr_type, tmp53) ;
// ATSlocal_void (tmp54) ;
ATSlocal (ats_bool_type, tmp55) ;
ATSlocal (ats_int_type, tmp56) ;
ATSlocal (ats_ptr_type, tmp57) ;
// ATSlocal_void (tmp58) ;
ATSlocal (ats_bool_type, tmp59) ;
ATSlocal (ats_int_type, tmp60) ;
ATSlocal (ats_int_type, tmp61) ;

__ats_lab_mainats:
tmp47 = atspre_ilt (arg0, 3) ;
if (tmp47) {
tmp49 = ats_caselptrind_mac(ats_ptr_type, arg1, [0]) ;
/* tmp48 = */ usage_7 (tmp49) ;
/* tmp46 = */ ats_exit (1) ;
} else {
/* empty */
} /* end of [if] */
tmp51 = atspre_igte (arg0, 3) ;
/* tmp50 = */ atspre_assert (tmp51) ;
tmp53 = ats_caselptrind_mac(ats_ptr_type, arg1, [1]) ;
tmp52 = atspre_int1_of_string (tmp53) ;
tmp55 = atspre_igt (tmp52, 0) ;
/* tmp54 = */ atspre_assert_errmsg (tmp55, ATSstrcst("The 1st integer argument is not positive.\n")) ;
tmp57 = ats_caselptrind_mac(ats_ptr_type, arg1, [2]) ;
tmp56 = atspre_int1_of_string (tmp57) ;
tmp59 = atspre_igt (tmp56, 0) ;
/* tmp58 = */ atspre_assert_errmsg (tmp59, ATSstrcst("The 2nd integer argument is not positive.\n")) ;
tmp60 = gcd_main_6 (tmp52, tmp56) ;
tmp61 = ats_selsin_mac(tmp60, atslab_1) ;
/* tmp45 = */ atspre_printf_exn (ATSstrcst("The greatest common divisor of (%i, %i) is %i.\n"), tmp52, tmp56, tmp61) ;
return /* (tmp45) */ ;
} /* end of [mainats] */

/* static load function */

// extern ats_void_type ATS_2d0_2e2_2e12_2libc_2SATS_2pthread_2esats__staload (void) ;
extern ats_void_type ATS_2d0_2e2_2e12_2libc_2DATS_2pthread_2edats__staload (void) ;
// extern ats_void_type ATS_2d0_2e2_2e12_2libc_2SATS_2pthread_uplock_2esats__staload (void) ;

ats_void_type
ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__staload () {
static int ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__staload_flag = 0 ;
if (ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__staload_flag) return ;
ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__staload_flag = 1 ;

// ATS_2d0_2e2_2e12_2libc_2SATS_2pthread_2esats__staload () ;
ATS_2d0_2e2_2e12_2libc_2DATS_2pthread_2edats__staload () ;
// ATS_2d0_2e2_2e12_2libc_2SATS_2pthread_uplock_2esats__staload () ;

return ;
} /* staload function */

/* dynamic load function */

// dynload flag declaration
// extern ats_int_type ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__dynload_flag ;

ats_void_type
ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__dynload () {
// ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__dynload_flag = 1 ;
ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__staload () ;

#ifdef _ATS_PROOFCHECK
ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__gcd_lemma0_prfck () ;
ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__gcd_lemma1_prfck () ;
ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__gcd_lemma2_prfck () ;
ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__gcd_lemma3_prfck () ;
ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__discard_prfck () ;
#endif /* _ATS_PROOFCHECK */

/* marking static variables for GC */

/* marking external values for GC */

/* code for dynamic loading */
return ;
} /* end of [dynload function] */

int main (int argc, char *argv[]) {
ATS_GC_INIT() ;
mainats_prelude() ;
ATS_2d0_2e2_2e12_2doc_2EXAMPLE_2MISC_2gcd_mt_2edats__dynload() ;
mainats((ats_int_type)argc, (ats_ptr_type)argv) ;
return (0) ;
} /* end of main */

/* external codes at mid */
/* external codes at bot */

/* ****** ****** */

/* end of [gcd_mt_dats.c] */
